include <parameters.scad>
include <stabilizer_spacing.scad>

/* [Layout Values] */
/* Layout Format (each key):
    [
        [                                       // Location Data
            [x_location, y_location],
            key_size,
            [rotation, rotation_x, rotation_y],
        ],
        [                                       // Borders
            top_border,
            bottom_border,
            left_border,
            right_border
        ],
        extra_data                              // Extra data (depending on component type)
    ]
*/

// Keyswitch Layout
//     (extra_data = rotate_column)
base_switch_layout = [
  //3
[[[4.2010498687664,1.19580052493438],1,[-360,4.7010498687664,1.69580052493438]],[3,2,2,2],false],
  //2
[[[3.18951364829396,1.41275942257218],1,[-1,3.68951364829396,1.91275942257218]],[3,2,2,2],false],
  //1
[[[2.18219223097113,1.45834776902887],1,[-1.80000000000001,2.68219223097113,1.95834776902887]],[4,2,3,1],false],
  //F4
[[[6.25673742782152,0.8918022572178499],1,[-1.89999999999998,6.75673742782152,1.39180225721785]],[3,3,2,3],false],
  //4
[[[5.2037456167979,1.6375524934383199],1,[-2.39999999999998,5.7037456167979,2.13755249343832]],[1,3,2,3],false],
  //F5
  [[[7.35702645669291,1.6328280839895002],1,[-2.39999999999998,7.85702645669291,2.1328280839895]],[2,3,4,1],false],
  //5
[[[6.19913774278215,2.04750839895013],1,[-3.89999999999998,6.69913774278215,2.54750839895013]],[3,2,2,2],false],
  //E
[[[4.14670640419947,2.22828965879265],1,[-4.5,4.64670640419947,2.72828965879265]],[2,2,2,2],false],
  //R
  [[[5.13627874015748,2.65789049868766],1,[-5.10000000000002,5.63627874015748,3.15789049868766]],[2,2,2,2],false],
  //F6
[[[7.29008451443569,2.7917487664042],1,[-5.10000000000002,7.79008451443569,3.2917487664042]],[3,3,3,2],false],
  //W
[[[3.12693832020997,2.44626593175853],1,[-5.89999999999998,3.62693832020997,2.94626593175853]],[2,2,2,2],false],
  //T
[[[6.1117298687664,3.05872372703412],1,[-6,6.6117298687664,3.55872372703412]],[2,2,2,3],false],
  //Home
[[[7.16137942257218,3.9496355380577404],1,[-7.80000000000001,7.66137942257218,4.44963553805774]],[3,3,3,2],false],
  //Q
[[[2.08866141732283,2.50596236220472],1,[-9,2.58866141732283,3.00596236220472]],[2,3,2,2],false],
  //D
[[[4.03900157480315,3.25851291338583],1,[-9.89999999999998,4.53900157480315,3.75851291338583]],[2,3,2,2],false],
  //F
[[[4.98587826771653,3.6925105511811003],1,[-11.5,5.48587826771653,4.1925105511811]],[2,2,2,2],false],
  //ESC
[[[0.02294834645669297,0.88521527559055],1,[-12.6,0.522948346456693,1.38521527559055]],[1,3,1,1],false],
  //Win
[[[0.03588797900262397,5.16867984251968],1.25338582677165,[-12.6,0.662580892388451,5.66867984251968]],[1,2,1+0.126692913385825*unit*mm,1+0.126692913385825*unit*mm],false],
  //Shift
[[[0.09940503937007905,4.15555648293963],1.25338582677165,[-12.6,0.726097952755906,4.65555648293963]],[1,2,1+0.126692913385825*unit*mm,1+0.126692913385825*unit*mm+3],false],
  //CAPS
[[[0.143312073490809,3.19334304461942],1.74540682414698,[-12.6,1.0160154855643,3.69334304461942]],[1,1,1+0.37270341207349*unit*mm,1+0.37270341207349*unit*mm],false],
  //TAB
[[[0.578853858267721,2.24007091863517],1.4997375328084,[-12.6,1.32872262467192,2.74007091863517]],[1,1,1+0.24986876640419997*unit*mm+2,1+0.24986876640419997*unit*mm],false],
  //~
[[[1.10851265091864,1.27786619422572],1,[-12.6,1.60851265091864,1.77786619422572]],[1,1,2,1],false],
  //S
[[[2.95647107611549,3.4849132808399],1,[-13.2,3.45647107611549,3.9849132808399]],[3,3,2,2],false],
  //G
[[[5.94397060367454,4.09814887139108],1,[-13.5,6.44397060367454,4.59814887139108]],[3,3,2,3],false],
  //A
[[[1.8832476115485601,3.55154104986877],1,[-16.8,2.38324761154856,4.05154104986877]],[3,3,2,2],false],
  //C
[[[3.7898355380577398,4.28506818897638],1,[-18.1,4.28983553805774,4.78506818897638]],[3,3,2,2],false],
  //V
[[[4.71412482939632,4.7080087664042],1,[-19,5.21412482939632,5.2080087664042]],[3,3,2,2],false],
  //End
[[[6.91154635170604,5.01863627296588],1,[-19.1,7.41154635170604,5.51863627296588]],[3,3,3,1],false],
  //B
[[[5.64927433070866,5.1127045144357],1,[-20.6,6.14927433070866,5.6127045144357]],[3,5,2,3],false],
  //Insert
[[[6.52576729658793,6.11656923884514],1,[-21.3,7.02576729658793,6.61656923884514]],[4,3,3,1],false],
  //X
[[[2.63870776902887,4.49471900262467],1,[-21.5,3.13870776902887,4.99471900262467]],[3,4,3,2],false],
  //Z
[[[1.52789732283465,4.5381582152231],1,[-22.4,2.02789732283465,5.0381582152231]],[2,1,3,2],false],
  //Right
[[[4.34115427821522,5.68306650918635],1,[-23.1,4.84115427821522,6.18306650918635]],[2,1,2,2],false],
  //Left
[[[3.42666650918635,5.25746094488189],1,[-23.5,3.92666650918635,5.75746094488189]],[2,1,2,2],false],
  //~
[[[5.10419716535433,7.670040682414699],2.24409448818898,[-119.9,6.22624440944882,8.1700406824147]],[2,2,1+0.62204724409449*unit*mm,1+0.62204724409449*unit*mm+1],false],
  //Ctrl
[[[6.56325832020997,8.50632745406824],1.2498687664042,[-136.9,7.18819270341207,9.00632745406824]],[1,5,1+0.12493438320210004*unit*mm,1+0.12493438320210004*unit*mm],false],
  //Alt
[[[4.9939922834645705,6.46455790026247],1.2498687664042,[-294,5.61892666666667,6.96455790026247]],[2,2,1+0.12493438320210004*unit*mm,1+0.12493438320210004*unit*mm+3],false],
  //F1
[[[3.16187711286089,0.23399748031496104],1,[-356,3.66187711286089,0.733997480314961]],[3,1,2,2],false],
  //F2
[[[4.16765139107611,0.018249448818898006],1,[-356,4.66765139107611,0.518249448818898]],[1,1,2,2],false],
  //F3
[[[5.22467202099738,0.47100750656168],1,[-359.9,5.72467202099738,0.97100750656168]],[1,3,2,2],false],
];

// MCU Position(s)
//base_mcu_layout = [];
base_mcu_layout = [
    [[[-0.8,1],mcu_h_unit_size,[80,0,0]],[1,4,4,1]],
];

// TRRS Position(s)
//base_trrs_layout = [];
 base_trrs_layout = [
     [[[7.4,0.5],1,[0,0,0.5]],[1,1,1,1]],
 ];

// Plate Layout (if different than PCB)
//     (extra_data = component_type)
base_plate_layout = [
    concat(
//        slice(base_switch_layout, [0,-2]),
//        [
//            [[[6,0.5],mcu_h_unit_size],[-2,0,3,0], ["mcu"]],
//            [[[6.5,2.5],1,[-90,7,3]],[0,0.5*h_unit,0,5.97], ["trrs"]]
//        ]
    ),
    [
 [[[-0.369230769230769,-0.247188106011634],1,[0,0,0]],[1,1,1,1]],
 [[[0.87808661926309,-0.979444085326441],1,[0,0,0]],[1,1,1,1]],
 [[[7.96483516483517,-0.00517129928894752],1,[0,0,0]],[1,1,1,1]],
 [[[8.00723981900452,2.50290885585003],1,[0,0,0]],[1,1,1,1]],
 [[[-0.469553975436328,4.64486102133161],1,[0,0,0]],[1,1,1,1]],
 [[[7.47873303167421,6.84576599870717],1,[0,0,0]],[1,1,1,1]],


//        [[[0,-0.3],1.5,[0,0,0]],[1,1,1,1]],
//        [[[7,-0.5],1.5,[0,0,0]],[1,1,1,1]],
//        [[[7,8],1.5,[0,0,0]],[1,1,1,1]],
//        [[[7,8],1.5,[0,0,0]],[1,1,1,1]],
//        [[[0,5.5],1.5,[0,0,0]],[1,1,1,1]],
//        [[[4.875,4.625],1.5,[60,4.875,4.625]],[30*mm,1,0.25*unit*mm,17.11*mm]],
//        [[[4.875,5.625],1.5,[60,4.875,4.625]],[1,0,0.25*unit*mm,17.11*mm]],
    ]

];

// Whether to only use base_plate_layout to generate the plate footprint
use_plate_layout_only = false;

// Stabilizer layout
//     (extra_data = [key_size, left_offset, right_offset, switch_offset=0])
//     (see stabilizer_spacing.scad for presets)
base_stab_layout = [
[[[5.10419716535433,7.670040682414699],2.24409448818898,[-119.9,6.22624440944882,8.1700406824147]],[1,2,1,1],2_25u],

];

// Standoff hole layout
//     (extra_data = [standoff_integration_override, standoff_attachment_override])
// base_standoff_layout = [];
base_standoff_layout = [

    //L1V1
    [[[0.5,-1]],[0,0,0,0],["plate", "backplate"]],
    //L1V2
    [[[-0.3,0]],[0,0,0,0],["plate", "backplate"]],
   //L1V3
    [[[0.2,2.5]],[0,0,0,0]],
    //L1V4
    [[[-0.3,5.6]],[0,0,0,0],["plate", "backplate"]],
    
    //L2V1
    [[[3,-0.3]],[0,0,0,0],["plate", "backplate"]],
    //L2V2
    [[[2.6,2.9]],[0,0,0,0]],
    //L2V3
    [[[2.4,5.1]],[0,0,0,0],["plate", "backplate"]],
 
    //L2.5V2
    [[[4.6,2.9]],[0,0,0,0],["plate", "backplate"]],

   
    //L3V1
    [[[6.3,0.3]],[0,0,0,0],["plate", "backplate"]],
    //L3V2
    [[[5.55,3.5]],[0,0,0,0]],
    //L3V3
    [[[5.2,8.6]],[0,0,0,0],["plate", "backplate"]],

    //L3.5V2
    [[[6,6]],[0,0,0,0]],

    //L4V1
    [[[8,0]],[0,0,0,0],["plate", "backplate"]],
    //L4V2
    [[[7.8,3.4]],[0,0,0,0]],
    //L4V3
    [[[7.5,8.2]],[0,0,0,0],["plate", "backplate"]],
    //L4V4
    [[[6.4,9.3]],[0,0,0,0],["plate", "backplate"]],

];

// Via layout 
//     (extra_data = [via_diameter, via_length])
//base_via_layout = [];
base_via_layout = [
    [[[1.6,0.7],1,[-11,1.6,0.7]],[1,1,1,1]],
];

// Whether to flip the layout
invert_layout_flag = false;

// Whether the layout is staggered-row or staggered-column
layout_type = "column";  // [column, row]
